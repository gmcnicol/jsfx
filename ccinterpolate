// This script is a MIDI CC Interpolator. It takes an input CC value and interpolates it between a start and end value.
// The interpolated value is then sent out on a specified MIDI channel and CC number.
desc:MIDI CC Interpolator

// Initialize variables
slider1:0<0,127,1>Input CC value
slider2:0<0,127,1>Start Value
slider3:127<0,127,1>End Value
slider4:0<0,15,1>MIDI Channel Out
slider5:0<1,127,1>CC Number
slider6:0<0,1,1>Interpolation Mode (0 = Normal, 1 = Reverse)

in_pin:none
out_pin:none

@init
function interpolate(cc, startValue, endValue) (
  startValue + (cc * (endValue - startValue)) / 127;
);

function reverseInterpolate(cc, startValue, endValue) (
  endValue - (cc * (endValue - startValue)) / 127;
);

previousCCValue = -1;

@slider
currentCCValue = slider1;
startValue = slider2;
endValue = slider3;
midiChannelOut = slider4;
ccNumber = slider5;
interpolationMode = slider6;

@block
currentCCValue != previousCCValue ? (
  interpolatedValue = interpolationMode == 0 ? interpolate(currentCCValue, startValue, endValue) : reverseInterpolate(currentCCValue, startValue, endValue);
  midisend(0, 0xB0 | midiChannelOut, ccNumber, interpolatedValue);
  previousCCValue = currentCCValue;
);

@sample
// Per-sample processing code here

@gfx
// GUI code here
